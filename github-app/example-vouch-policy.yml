# Vouch Gatekeeper v2.0 - Example Policy Configuration
# 
# Place this file at: .github/vouch-policy.yml
# 
# If this file is missing, Zero-Config defaults apply:
# - require_signed_commits: true
# - allow_bots: true  
# - policy_type: implicit_organization_trust (org members allowed)

version: 1

policy:
  # ==========================================================================
  # Level 1: Signature Requirements
  # ==========================================================================
  
  # Require all commits to be cryptographically signed
  require_signed_commits: true
  
  # Allow unsigned merge commits (generated by GitHub's "Merge" button)
  # Set to false to enforce rebase-and-merge or squash-and-merge only
  allow_unsigned_merge_commits: false

  # ==========================================================================
  # Level 2: Bot Handling
  # ==========================================================================
  
  # Allow known bot accounts (Dependabot, GitHub Actions, Renovate)
  allow_bots: true

  # ==========================================================================
  # Level 3: Policy Type
  # ==========================================================================
  
  # Options:
  # - "implicit_organization_trust": Any org member is allowed (Zero-Config default)
  # - "explicit": Only entries in allowed_organizations/allowed_users are allowed
  policy_type: explicit

  # ==========================================================================
  # Level 4: Organization Authorization
  # ==========================================================================
  
  # Only allow commits from members of these Vouch-verified organizations
  # (Only applies when policy_type is "explicit")
  allowed_organizations:
    - "did:vouch:optum"
    - "did:vouch:uhg"

  # ==========================================================================
  # Level 5: Individual User Authorization
  # ==========================================================================
  
  # Explicitly allowed individual DIDs or GitHub usernames
  # Use "github:" prefix for GitHub usernames
  allowed_users:
    - "did:vouch:contractor_bob"
    - "did:vouch:external_auditor"
    - "github:trusted-contributor"

# ==========================================================================
# Example Configurations
# ==========================================================================

# STARTUP (Zero-Config, remove this file):
# No file needed! App uses implicit_organization_trust by default.

# OPEN SOURCE PROJECT (permissive):
# policy:
#   require_signed_commits: false
#   allow_bots: true
#   policy_type: implicit_organization_trust

# ENTERPRISE (moderate):
# policy:
#   require_signed_commits: true
#   allow_unsigned_merge_commits: true
#   allow_bots: true
#   policy_type: implicit_organization_trust

# HIGHLY REGULATED (strict):
# policy:
#   require_signed_commits: true
#   allow_unsigned_merge_commits: false
#   allow_bots: false
#   policy_type: explicit
#   allowed_organizations:
#     - "did:vouch:mycompany"
#   allowed_users: []
