\input{../common/preamble}

\title{Chain of Custody Delegation in Multi-Agent Systems}

\author{Ramprasad Anandam Gaddam\\
\textit{Vouch Protocol Project}\\
\url{https://vouch-protocol.com}\\
\texttt{ram@vouch-protocol.com}}

\date{January 2026}

\begin{document}
\maketitle

\begin{abstract}
This paper addresses the problem of maintaining cryptographic accountability when AI agents delegate tasks to other agents. We present a delegation chain protocol that enables verifiable tracking of action lineage through linked cryptographic attestations. Each agent in a delegation chain signs their portion of work while referencing their delegator's attestation, creating an auditable and tamper-evident trail of responsibility. We formalize the delegation model, define the chain structure, and analyze the security properties achieved. The protocol enables enterprise compliance, liability attribution, and transparent multi-agent coordination.

\seriesnote
\end{abstract}

\textbf{Keywords:} delegation, chain of custody, multi-agent systems, cryptographic attestation, accountability

\section{Introduction}

Modern AI systems increasingly operate as multi-agent architectures where specialized agents collaborate to accomplish complex tasks. A personal assistant agent may delegate research to a specialized research agent, which in turn may delegate web scraping to a data collection agent. This delegation pattern creates a fundamental accountability challenge: when an action causes harm or exceeds authorized scope, determining which agent is responsible becomes difficult without a verifiable audit trail.

\subsection{Problem Statement}

Consider a multi-agent system where Agent $A$ delegates to Agent $B$, which further delegates to Agent $C$. If Agent $C$ performs an unauthorized action, the following questions arise:
\begin{enumerate}
    \item Did Agent $B$ authorize Agent $C$ to perform this action?
    \item Did Agent $A$ authorize Agent $B$ with sufficient scope?
    \item Can any party deny their role in the delegation chain?
\end{enumerate}

\subsection{Contributions}

This paper makes the following contributions:
\begin{itemize}
    \item Formal model for delegation in multi-agent systems
    \item Protocol for cryptographically linked delegation chains
    \item Scope constraint propagation mechanism
    \item Security analysis of chain integrity properties
\end{itemize}

\section{Background}

\subsection{Delegation in Distributed Systems}

\begin{definition}[Delegation]
A delegation is a tuple $D = (\mathsf{delegator}, \mathsf{delegatee}, \mathsf{scope}, \mathsf{constraints}, \sigma)$ where the delegator authorizes the delegatee to perform actions within the specified scope, subject to constraints, signed by $\sigma$.
\end{definition}

Delegation differs from simple authorization in that the delegatee acts \textit{on behalf of} the delegator, creating a chain of responsibility.

\subsection{Hash Chains}

\begin{definition}[Hash Chain]
A hash chain is a sequence of records where each record $r_i$ includes the cryptographic hash of the previous record:
\begin{equation}
r_i.\mathsf{prev\_hash} = H(r_{i-1})
\end{equation}
where $H$ is a collision-resistant hash function.
\end{definition}

Hash chains provide tamper-evidence: modifying any record invalidates all subsequent hashes \citep{merkle1988}.

\section{Delegation Chain Protocol}

\subsection{Chain Structure}

\begin{definition}[Delegation Chain]
A delegation chain $C = (D_0, D_1, \ldots, D_n)$ is a sequence of delegations where:
\begin{equation}
D_i.\mathsf{parent\_hash} = H(D_{i-1}) \quad \forall i > 0
\end{equation}
and each $D_i$ is signed by $D_{i-1}.\mathsf{delegatee}$.
\end{definition}

\subsection{Delegation Token Structure}

\begin{lstlisting}[language=json]
{
  "type": "delegation",
  "delegator": "did:web:agent-a.example.com",
  "delegatee": "did:web:agent-b.example.com",
  "scope": {
    "action": "research",
    "max_queries": 10,
    "allowed_domains": ["*.wikipedia.org"]
  },
  "parent_hash": "sha256:abc123...",
  "created_at": "2026-01-10T12:00:00Z",
  "expires": "2026-01-10T12:05:00Z"
}
\end{lstlisting}

\subsection{Scope Propagation}

\begin{property}[Scope Monotonicity]
A delegatee cannot grant more authority than they possess:
\begin{equation}
\mathsf{scope}(D_i) \subseteq \mathsf{scope}(D_{i-1})
\end{equation}
\end{property}

This property ensures that delegation chains cannot escalate privileges.

\subsection{Chain Verification}

To verify action $a$ performed by Agent $C$ at chain depth $n$:

\begin{enumerate}
    \item Obtain Agent $C$'s attestation $A_n$ for action $a$
    \item Verify $\mathsf{signature}(A_n)$ using $C$'s public key
    \item Follow $A_n.\mathsf{parent\_hash}$ to obtain $D_{n-1}$
    \item Verify $a \in \mathsf{scope}(D_{n-1})$
    \item Recursively verify delegation chain to root
    \item Verify root delegator has sufficient authority
\end{enumerate}

\section{Security Analysis}

\begin{property}[Chain Integrity]
Any modification to a delegation in the chain invalidates all subsequent parent hashes.
\end{property}

\begin{property}[Non-Repudiation]
Each delegation is signed by the delegator. The signature serves as cryptographic evidence of authorization.
\end{property}

\begin{property}[Scope Enforcement]
Actions outside delegated scope can be detected by comparing action parameters against scope constraints.
\end{property}

\begin{property}[Temporal Validity]
Expired delegations are rejected, limiting the window for misuse.
\end{property}

\section{Related Work}

\textbf{SPIFFE/SPIRE} provides workload identity but lacks delegation chaining with scope constraints.

\textbf{OAuth 2.0 Token Exchange} \citep{rfc6749} supports token delegation but without cryptographic chain linking.

\textbf{Verifiable Credentials} \citep{w3c-vc} provide credential chaining; our work extends this to action delegation.

\section{Implementation}

Reference implementation available at \url{https://github.com/vouch-protocol/vouch}.

The implementation provides:
\begin{itemize}
    \item Delegation token creation and signing
    \item Chain verification with scope checking
    \item Integration with PAD-001 identity tokens
\end{itemize}

\section{Conclusion}

This paper presented a cryptographic delegation chain protocol for multi-agent systems. By linking attestations through hash chains and enforcing scope monotonicity, the protocol enables verifiable accountability across delegation hierarchies. Future work includes dynamic scope renegotiation and revocation mechanisms.

\priorartbox

\vouchsign{pad002}{Ramprasad Anandam Gaddam}{github:rampyg}

\bibliography{../common/references}

\end{document}
