\input{../common/preamble}

\title{Content-Addressed Signature Recovery via Reverse Lookup Registry}

\author{Ramprasad Anandam Gaddam\\
\textit{Vouch Protocol Project}\\
\url{https://vouch-protocol.com}\\
\texttt{ram@vouch-protocol.com}}

\date{January 2026}

\begin{document}
\maketitle

\begin{abstract}
This paper presents a method for recovering cryptographic signatures when they are stored separately from the content they authenticate. We introduce a reverse lookup registry that indexes signatures by content hash, enabling verification even when signatures were not transmitted alongside content. This addresses the common scenario where content undergoes transformations that strip metadata, such as social media uploads, format conversions, or screenshots. We formalize the registry data model, specify the lookup protocol, and analyze scalability and security properties.

\seriesnote
\end{abstract}

\textbf{Keywords:} content addressing, hash-based lookup, detached signatures, signature recovery, registry

\section{Introduction}

Detached signatures, where the signature is stored separately from the signed content, create a discoverability problem. When content is shared without its accompanying signature---due to metadata stripping, format conversion, or transmission through channels that don't preserve attachments---the recipient has no way to know that a signature exists or where to find it.

We propose a reverse lookup registry: a service that indexes signatures by the cryptographic hash of the content they sign. Given arbitrary content, a verifier can compute its hash and query the registry to discover any registered signatures.

\subsection{Contributions}

\begin{itemize}
    \item Formal model for content-addressed signature storage
    \item Registry protocol specification
    \item Scalability analysis and sharding strategies
    \item Security considerations for registry trust
\end{itemize}

\section{Background}

\subsection{Cryptographic Hash Functions}

\begin{definition}[Cryptographic Hash]
A cryptographic hash function $H: \{0,1\}^* \rightarrow \{0,1\}^n$ maps arbitrary-length input to fixed-length output with properties:
\begin{itemize}
    \item Collision resistance: Infeasible to find $x \neq y$ where $H(x) = H(y)$
    \item Preimage resistance: Given $h$, infeasible to find $x$ where $H(x) = h$
\end{itemize}
\end{definition}

We use SHA-256 for content addressing.

\subsection{Content Addressing}

\begin{definition}[Content Address]
A content address is the cryptographic hash of content, serving as a unique identifier:
\begin{equation}
\mathsf{addr}(c) = H(c)
\end{equation}
\end{definition}

Content addressing enables location-independent content identification, used in systems like IPFS and Git.

\section{Reverse Lookup Registry}

\subsection{Data Model}

\begin{definition}[Registry Record]
A registry record $R = (\mathsf{hash}, \mathsf{sig}, \mathsf{signer}, \mathsf{timestamp})$ maps:
\begin{itemize}
    \item $\mathsf{hash}$: SHA-256 hash of the signed content
    \item $\mathsf{sig}$: The detached signature (or URL to signature)
    \item $\mathsf{signer}$: DID of the signing entity
    \item $\mathsf{timestamp}$: Registration time
\end{itemize}
\end{definition}

\subsection{Registry Record Format}

\begin{lstlisting}[language=json]
{
  "content_hash": "sha256:a3f2b7c9d8e4f1a2...",
  "content_type": "image/jpeg",
  "signer_did": "did:web:alice.example.com",
  "signature": "eyJhbGciOiJFZERTQSJ9...",
  "registered_at": "2026-01-10T12:00:00Z"
}
\end{lstlisting}

\subsection{Registration Protocol}

To register a signature:
\begin{enumerate}
    \item Signer computes $h = H(c)$ for content $c$
    \item Signer creates signature $\sigma = \mathsf{Sign}(sk, c)$
    \item Signer submits $(h, \sigma, \mathsf{DID})$ to registry
    \item Registry stores mapping $h \mapsto (\sigma, \mathsf{DID}, t)$
\end{enumerate}

\subsection{Lookup Protocol}

To discover signatures for content:
\begin{enumerate}
    \item Verifier computes $h = H(c)$
    \item Verifier queries: $\mathsf{GET\ /lookup?hash=}h$
    \item Registry returns all matching records
    \item Verifier fetches signer public keys and verifies signatures
\end{enumerate}

\section{Scalability Analysis}

\subsection{Storage Requirements}

Each record requires approximately 500 bytes. At 1 billion records:
\begin{equation}
\mathsf{Storage} \approx 500 \text{ GB}
\end{equation}

\subsection{Sharding Strategy}

The registry can be sharded by hash prefix:
\begin{equation}
\mathsf{shard}(h) = h[0:k] \mod n
\end{equation}

where $k$ is prefix length and $n$ is shard count.

\subsection{Query Performance}

Hash-based lookup is $O(1)$ with proper indexing. Bloom filters can accelerate negative lookups.

\section{Security Considerations}

\begin{property}[Registry Non-Authority]
The registry does not validate signatures; it only stores them. Verifiers perform cryptographic validation independently.
\end{property}

\begin{property}[Multiple Signatures]
The same content hash may have multiple registered signatures from different signers, representing multiple attestations.
\end{property}

\textbf{Threat: Spam registration.} Mitigation: Rate limiting, proof-of-work, or staking.

\textbf{Threat: False claims.} Mitigation: Verifiers independently validate signatures against signer public keys.

\section{Related Work}

\textbf{IPFS} uses content addressing for distributed storage; our work applies content addressing to signature indexing.

\textbf{Certificate Transparency} logs certificate issuance for public auditing; our registry provides signature discoverability.

\textbf{Keybase} provided identity proofs with signature storage; our approach is decentralized and protocol-agnostic.

\section{Implementation}

Reference implementation available at \url{https://github.com/vouch-protocol/vouch}.

The registry is implemented as:
\begin{itemize}
    \item Cloudflare Worker with KV storage for low-latency global access
    \item REST API with hash-based lookup
    \item Integration with Smart Scan browser extension (PAD-004)
\end{itemize}

\section{Conclusion}

This paper presented a reverse lookup registry for content-addressed signature recovery. By indexing signatures by content hash, the registry enables verification of content even when signatures were not transmitted alongside it. The approach is scalable through sharding and maintains security through verifier-side cryptographic validation.

\priorartbox

\vouchsign{pad005}{Ramprasad Anandam Gaddam}{github:rampyg}

\bibliography{../common/references}

\end{document}
