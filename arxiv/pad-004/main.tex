\input{../common/preamble}

\title{DOM-Based Automatic Signature Detection and Verification}

\author{Ramprasad Anandam Gaddam\\
\textit{Vouch Protocol Project}\\
\url{https://vouch-protocol.com}\\
\texttt{ram@vouch-protocol.com}}

\date{January 2026}

\begin{document}
\maketitle

\begin{abstract}
This paper presents a browser-based method for automatically detecting and verifying cryptographic signatures embedded in web content. The system, termed ``Smart Scan,'' traverses the Document Object Model (DOM) to locate signature blocks, extracts signed content and detached signatures, performs cryptographic verification, and displays verification results inline. This enables ambient verification---users can observe at a glance which content on a page has been cryptographically attested without manual verification steps. We specify the detection algorithm, define the signature embedding format, and analyze privacy properties.

\seriesnote
\end{abstract}

\textbf{Keywords:} browser extension, DOM traversal, signature verification, web security, ambient verification

\section{Introduction}

The proliferation of AI-generated content has intensified the need for content authenticity verification. Cryptographic signatures can provide such verification, but existing approaches require users to manually copy content into verification tools. This friction reduces adoption.

We present Smart Scan, a browser extension that automates signature detection and verification. Upon page load, the extension:
\begin{enumerate}
    \item Scans the DOM for signature markers
    \item Extracts signed content and signatures
    \item Performs local cryptographic verification
    \item Displays inline verification badges
\end{enumerate}

\subsection{Contributions}

\begin{itemize}
    \item Specification of in-content signature embedding format
    \item DOM traversal algorithm for signature detection
    \item Privacy-preserving local verification architecture
    \item Browser extension reference implementation
\end{itemize}

\section{Background}

\subsection{Document Object Model}

\begin{definition}[DOM]
The Document Object Model represents an HTML document as a tree of nodes, where each element, attribute, and text segment is a node accessible via standard APIs.
\end{definition}

Browser extensions can traverse and modify the DOM, enabling content analysis and augmentation.

\subsection{Detached Signatures}

\begin{definition}[Detached Signature]
A detached signature $\sigma$ is computed over content $c$ but stored separately:
\begin{equation}
\sigma = \mathsf{Sign}(sk, c), \quad \text{stored independently of } c
\end{equation}
\end{definition}

Unlike embedded signatures, detached signatures allow content to remain human-readable while maintaining verifiability.

\section{Signature Embedding Format}

\subsection{Marker Syntax}

Signed content is delimited with explicit markers:

\begin{lstlisting}
--- vouch:start ---
[signed content]
--- vouch:signature ---
[base64-encoded JWS]
--- vouch:end ---
\end{lstlisting}

\subsection{Format Specification}

\begin{definition}[Vouch Block]
A Vouch block $B = (m_s, c, m_\sigma, \sigma, m_e)$ consists of:
\begin{itemize}
    \item $m_s$: Start marker (\texttt{--- vouch:start ---})
    \item $c$: Signed content (arbitrary text)
    \item $m_\sigma$: Signature delimiter (\texttt{--- vouch:signature ---})
    \item $\sigma$: Base64-encoded JWS
    \item $m_e$: End marker (\texttt{--- vouch:end ---})
\end{itemize}
\end{definition}

\section{Detection Algorithm}

\subsection{DOM Traversal}

The extension performs the following on page load:

\begin{enumerate}
    \item Query: \texttt{document.body.innerText.matchAll(/--- vouch:start ---/g)}
    \item For each match, extract block boundaries
    \item Parse content between $m_s$ and $m_\sigma$
    \item Parse signature between $m_\sigma$ and $m_e$
    \item Queue for verification
\end{enumerate}

\subsection{Verification Process}

For each detected block:

\begin{enumerate}
    \item Decode JWS to extract header and payload
    \item Extract issuer DID from \texttt{iss} claim
    \item Resolve DID to obtain public key $pk$
    \item Verify: $\mathsf{Ed25519.Verify}(pk, c, \sigma) \stackrel{?}{=} 1$
    \item Generate verification result
\end{enumerate}

\subsection{Result Injection}

Verification results are displayed by injecting DOM elements:

\begin{lstlisting}[language=json]
{
  "status": "verified",
  "signer": "did:web:alice.example.com",
  "verified_at": "2026-01-10T12:00:00Z"
}
\end{lstlisting}

Visual indicators:
\begin{itemize}
    \item \textcolor{green}{Green checkmark}: Signature valid
    \item \textcolor{red}{Red X}: Signature invalid or content modified
    \item \textcolor{orange}{Yellow warning}: Verification failed (network error)
\end{itemize}

\section{Privacy Analysis}

\begin{property}[Local Verification]
All cryptographic operations occur within the browser. Content is never transmitted to external servers.
\end{property}

\begin{property}[Minimal Network Activity]
The only network requests are DID resolution to fetch public keys. These requests reveal that verification is occurring but not the content being verified.
\end{property}

\textbf{Mitigation for DID resolution privacy:} Cache DID documents locally with configurable TTL.

\section{Security Considerations}

\textbf{Marker Injection:} Malicious pages could inject fake markers with invalid signatures. The extension must clearly distinguish verification failure from verification success.

\textbf{Content Modification After Signing:} Any modification between $m_s$ and $m_\sigma$ invalidates the signature. This is the intended behavior.

\section{Related Work}

\textbf{DKIM for Email} provides header-based email authentication but does not support arbitrary web content.

\textbf{Signed HTTP Exchanges} (SXG) provide origin-signed web bundles but require server-side implementation.

\textbf{Content Authenticity Initiative} (CAI) focuses on media provenance; our approach is content-agnostic.

\section{Implementation}

Reference implementation available at \url{https://github.com/vouch-protocol/vouch}.

Browser extension available for:
\begin{itemize}
    \item Chrome (Manifest V3)
    \item Firefox
    \item Edge
\end{itemize}

\section{Conclusion}

This paper presented Smart Scan, a browser-based system for automatic signature detection and verification. By embedding signatures within content using a simple marker format, and providing ambient verification through a browser extension, we reduce the friction of content authenticity verification. The system preserves privacy through local verification while providing clear visual feedback to users.

\priorartbox

\vouchsign{pad004}{Ramprasad Anandam Gaddam}{github:rampyg}

\bibliography{../common/references}

\end{document}
